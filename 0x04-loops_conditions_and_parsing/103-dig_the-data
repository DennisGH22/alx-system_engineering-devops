#!/usr/bin/env bash
# Path to the Apache log file
log_file="apache-access.log"

# Check if the log file exists
if [ ! -f "$log_file" ]; then
    echo "Error: $log_file does not exist."
    exit 1
fi

# Use awk to extract and group the data by IP and HTTP status code,
# and then count the occurrences
awk '{ip_code[$1, $9]++} END {for (entry in ip_code) print ip_code[entry], entry}' "$log_file" \
    | sort -rn